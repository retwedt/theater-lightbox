function updateModal(e,t,r){"new"==r?buildTimeline(e):"timeline"==r?updateTimeline(t):"right"==r?(t==groups[e].length-1?t=0:t++,updateTimeline(t)):"left"==r?(0==t?t=groups[e].length-1:t--,updateTimeline(t)):console.log("error!!"),currentPosterGroup=e,currentPosterNum=t;var i,o,a=groups[currentPosterGroup][currentPosterNum].querySelector("img").alt,l=groups[currentPosterGroup][currentPosterNum].querySelector("img").title;"img"===groups[currentPosterGroup][currentPosterNum].dataset.type?(i=image.cloneNode(!0),o="img"):"vid"===groups[currentPosterGroup][currentPosterNum].dataset.type?(i=iframe.cloneNode(!0),o="vid"):console.log("wrong media type!"),i.setAttribute("src",a),modalContent.appendChild(i),setTimeout(function(){"img"==o?(mediaWidth=i.width,mediaHeight=i.height):"vid"==o?(mediaWidth=ytWidth,mediaHeight=ytHeight):console.log("another wrong media type!"),setModalDimesions(i)},10),modalText.textContent=l,modal.setAttribute("class","modal theater-modal-active")}function setModalDimesions(e){var t=mediaWidth/mediaHeight,r=.9*winHeight-80,i=r*t;i+48>=winWidth&&(i=.9*winWidth,r=i*(1/t)),e.style.height=r+"px",e.style.width=i+"px",modalContent.style.height=r+"px",modalContent.style.width=i+"px"}function clearModal(){modal.setAttribute("class","modal theater-modal-inactive");var e=modalContent.querySelector("img")||modalContent.querySelector("iframe");e&&setTimeout(function(){modalContent.removeChild(e)},500)}function buildTimeline(e){tlLength=groups[e].length;for(var t=0;t<tlLength;t++){var r=bigDot.cloneNode(!0);if(timelineMarkers.push(r),timelineWrap.appendChild(r),t!=tlLength-1){var i=smallDot.cloneNode(!0),o=smallDot.cloneNode(!0);timelineWrap.appendChild(i),timelineWrap.appendChild(o)}}var a=20*tlLength+20*(tlLength-1)*2;timelineWrap.style.width=a+"px",timelineMarkers[currentPosterNum].id="highlight";for(var l=0;l<timelineMarkers.length;l++)timelineMarkers[l].addEventListener("click",function(){var e=timelineMarkers.indexOf(this);currentPosterNum!=e&&(timelineMarkers[currentPosterNum].id="",currentPosterNum=e,clearModal(),setTimeout(function(){updateModal(currentPosterGroup,currentPosterNum,"timeline")},500),timelineMarkers[currentPosterNum].id="highlight")})}function updateTimeline(e){for(var t=0;t<timelineMarkers.length;t++)timelineMarkers[t].id="";timelineMarkers[e].id="highlight"}function clearTimeline(){for(;timelineWrap.firstChild;)timelineWrap.removeChild(timelineWrap.firstChild);timelineMarkers=[]}function getDimensions(){winWidth=document.documentElement.clientWidth,winHeight=document.documentElement.clientHeight;var e=modalContent.querySelector("img")||modalContent.querySelector("iframe");e&&setModalDimesions(e)}var modalWrap=document.createElement("div");modalWrap.setAttribute("class","modal-wrap theater-bg-inactive");var modal=document.createElement("div");modal.setAttribute("class","modal theater-modal-inactive"),modalWrap.appendChild(modal);var modalRight=document.createElement("div");modalRight.setAttribute("id","modal-right"),modal.appendChild(modalRight);var modalLeft=document.createElement("div");modalLeft.setAttribute("id","modal-left"),modal.appendChild(modalLeft);var modalClose=document.createElement("div");modalClose.setAttribute("id","modal-close"),modal.appendChild(modalClose);var modalContent=document.createElement("div");modalContent.setAttribute("class","modal-content"),modal.appendChild(modalContent);var modalText=document.createElement("div");modalText.setAttribute("class","modal-description"),modal.appendChild(modalText);var image=document.createElement("img"),iframe=document.createElement("iframe"),timelineWrap=document.createElement("div");timelineWrap.setAttribute("class","timeline-wrap"),modal.appendChild(timelineWrap);var bigDot=document.createElement("div");bigDot.setAttribute("class","dot-big");var smallDot=document.createElement("div");smallDot.setAttribute("class","dot-small");var body=document.querySelector("body");body.insertBefore(modalWrap,body.firstChild);var posters=document.querySelectorAll(".theater"),groupNames=[],groups={},currentPosterNum=0,currentPosterGroup="null",timelineMarkers=[],winWidth=0,winHeight=0,mediaWidth=0,mediaHeight=0,ytWidth=560,ytHeight=315;window.onload=getDimensions,window.onresize=getDimensions;for(var i=0;i<posters.length;i++){var curName=posters[i].dataset.theaterGroup,add=!1;if(0===groupNames.length)groups[curName]=[],add=!0;else for(var j=0;j<groupNames.length;j++){if(curName===groupNames[j]){add=!1;break}add=!0}add&&(groups[curName]=[],groupNames.push(curName)),groups[curName].push(posters[i]),posters[i].addEventListener("click",function(){currentPosterGroup=this.dataset.theaterGroup,currentPosterNum=groups[currentPosterGroup].indexOf(this),updateModal(currentPosterGroup,currentPosterNum,"new"),modalWrap.setAttribute("class","modal-wrap theater-bg-active"),modal.setAttribute("class","modal theater-modal-active")})}modalClose.onclick=function(){modalWrap.setAttribute("class","modal-wrap theater-bg-inactive"),modal.setAttribute("class","modal theater-modal-inactive"),currentPosterGroup="",currentPosterNum=0,clearModal(),clearTimeline()},modalRight.onclick=function(){groups[currentPosterGroup].length>1&&(clearModal(),setTimeout(function(){updateModal(currentPosterGroup,currentPosterNum,"right")},500))},modalLeft.onclick=function(){groups[currentPosterGroup].length>1&&(clearModal(),setTimeout(function(){updateModal(currentPosterGroup,currentPosterNum,"left")},500))};
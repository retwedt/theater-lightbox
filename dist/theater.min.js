!function(){function t(){this.posters=document.querySelectorAll(".theater"),this.groupNames=[],this.groups={},this.currentPosterNum=0,this.currentPosterGroup="null",this.timelineMarkers=[],this.mediaWidth=0,this.mediaHeight=0,this.ytWidth=560,this.ytHeight=315,this.modalWrap,this.modal,this.modalRight,this.modalLeft,this.modalClose,this.modalContent,this.modalText,this.image,this.iframe,this.timelineWrap,this.bigDot,this.smallDot}var e,i=0,r=0,o=function(){e=new t,e.buildModal(),e.setup(),e._getDimensions()},s=function(){e._getDimensions()};window.addEventListener("load",o),window.addEventListener("resize",s),t.prototype.buildModal=function(){this.modalWrap=document.createElement("div"),this.modalWrap.setAttribute("class","modal-wrap theater-bg-inactive"),this.modal=document.createElement("div"),this.modal.setAttribute("class","modal theater-modal-inactive"),this.modalWrap.appendChild(this.modal),this.modalRight=document.createElement("div"),this.modalRight.setAttribute("id","modal-right"),this.modal.appendChild(this.modalRight),this.modalLeft=document.createElement("div"),this.modalLeft.setAttribute("id","modal-left"),this.modal.appendChild(this.modalLeft),this.modalClose=document.createElement("div"),this.modalClose.setAttribute("id","modal-close"),this.modal.appendChild(this.modalClose),this.modalContent=document.createElement("div"),this.modalContent.setAttribute("class","modal-content"),this.modal.appendChild(this.modalContent),this.modalText=document.createElement("div"),this.modalText.setAttribute("class","modal-description"),this.modal.appendChild(this.modalText),this.image=document.createElement("img"),this.iframe=document.createElement("iframe"),this.timelineWrap=document.createElement("div"),this.timelineWrap.setAttribute("class","timeline-wrap"),this.modal.appendChild(this.timelineWrap),this.bigDot=document.createElement("div"),this.bigDot.setAttribute("class","dot-big"),this.smallDot=document.createElement("div"),this.smallDot.setAttribute("class","dot-small");var t=document.querySelector("body");t.insertBefore(this.modalWrap,t.firstChild)},t.prototype.setup=function(){for(var t=this,e=0;e<this.posters.length;e++){var i=this.posters[e].dataset.theaterGroup,r=!1;if(0===this.groupNames.length)this.groups[i]=[],r=!0;else for(var o=0;o<this.groupNames.length;o++){if(i===this.groupNames[o]){r=!1;break}r=!0}r&&(this.groups[i]=[],this.groupNames.push(i)),this.groups[i].push(this.posters[e]),this.posters[e].addEventListener("click",function(){t.currentPosterGroup=this.dataset.theaterGroup,t.currentPosterNum=t.groups[t.currentPosterGroup].indexOf(this),t.updateModal(t.currentPosterGroup,t.currentPosterNum,"new"),t.modalWrap.setAttribute("class","modal-wrap theater-bg-active"),t.modal.setAttribute("class","modal theater-modal-active")})}this.modalClose.addEventListener("click",function(){t.modalWrap.setAttribute("class","modal-wrap theater-bg-inactive"),t.modal.setAttribute("class","modal theater-modal-inactive"),t.currentPosterGroup="",t.currentPosterNum=0,t.clearModal(),t._clearTimeline()}),this.modalRight.addEventListener("click",function(){t.groups[t.currentPosterGroup].length>1&&(t.clearModal(),setTimeout(function(){t.updateModal(t.currentPosterGroup,t.currentPosterNum,"right")},500))}),this.modalLeft.addEventListener("click",function(){t.groups[t.currentPosterGroup].length>1&&(t.clearModal(),setTimeout(function(){t.updateModal(t.currentPosterGroup,t.currentPosterNum,"left")},500))})},t.prototype.updateModal=function(t,e,i){var r=this;"new"==i?(this.currentPosterGroup=t,this._buildTimeline(t)):"timeline"==i?this._updateTimeline(e):"right"==i?(e==this.groups[t].length-1?e=0:e++,this._updateTimeline(e)):"left"==i?(0==e?e=this.groups[t].length-1:e--,this._updateTimeline(e)):console.log("error!!"),this.currentPosterGroup=t,this.currentPosterNum=e;var o,s,a=this.groups[this.currentPosterGroup][this.currentPosterNum].querySelector("img").alt,n=this.groups[this.currentPosterGroup][this.currentPosterNum].querySelector("img").title;"img"===this.groups[this.currentPosterGroup][this.currentPosterNum].dataset.theaterType?(o=this.image.cloneNode(!0),s="img"):"vid"===this.groups[this.currentPosterGroup][this.currentPosterNum].dataset.theaterType?(o=this.iframe.cloneNode(!0),s="vid"):"youTube"===this.groups[this.currentPosterGroup][this.currentPosterNum].dataset.theaterType?(o=this.iframe.cloneNode(!0),s="youTube"):console.log("wrong media type!"),o.setAttribute("src",a),this.modalContent.appendChild(o),setTimeout(function(){"img"==s?(r.mediaWidth=o.width,r.mediaHeight=o.height):"vid"==s?(r.mediaWidth=r.ytWidth,r.mediaHeight=r.ytHeight):"youTube"==s?(r.mediaWidth=r.ytWidth,r.mediaHeight=r.ytHeight):console.log("another wrong media type!"),r._setModalDimesions(o)},10),this.modalText.textContent=n,this.modal.setAttribute("class","modal theater-modal-active")},t.prototype._setModalDimesions=function(t){var e=this.mediaWidth/this.mediaHeight,o=.9*r-80,s=o*e;s+48>=i&&(s=.9*i,o=s*(1/e)),t.style.height=o+"px",t.style.width=s+"px",this.modalContent.style.height=o+"px",this.modalContent.style.width=s+"px"},t.prototype.clearModal=function(){var t=this;this.modal.setAttribute("class","modal theater-modal-inactive");var e=this.modalContent.querySelector("img")||this.modalContent.querySelector("iframe");e&&setTimeout(function(){t.modalContent.removeChild(e)},500)},t.prototype._buildTimeline=function(t){for(var e=this,i=this.groups[t].length,r=0;i>r;r++){var o=this.bigDot.cloneNode(!0);if(this.timelineMarkers.push(o),this.timelineWrap.appendChild(o),r!=i-1){var s=this.smallDot.cloneNode(!0),a=this.smallDot.cloneNode(!0);this.timelineWrap.appendChild(s),this.timelineWrap.appendChild(a)}}var n=20*i+20*(i-1)*2;this.timelineWrap.style.width=n+"px",this.timelineMarkers[this.currentPosterNum].id="highlight";for(var l=0;l<this.timelineMarkers.length;l++)this.timelineMarkers[l].addEventListener("click",function(){var t=e.timelineMarkers.indexOf(this);e.currentPosterNum!=t&&(e.timelineMarkers[e.currentPosterNum].id="",e.currentPosterNum=t,e.clearModal(),setTimeout(function(){e.updateModal(e.currentPosterGroup,e.currentPosterNum,"timeline")},500),e.timelineMarkers[e.currentPosterNum].id="highlight")})},t.prototype._updateTimeline=function(t){for(var e=0;e<this.timelineMarkers.length;e++)this.timelineMarkers[e].id="";this.timelineMarkers[t].id="highlight"},t.prototype._clearTimeline=function(){for(;this.timelineWrap.firstChild;)this.timelineWrap.removeChild(this.timelineWrap.firstChild);this.timelineMarkers=[]},t.prototype._getDimensions=function(){i=document.documentElement.clientWidth,r=document.documentElement.clientHeight;var t=this.modalContent.querySelector("img")||this.modalContent.querySelector("iframe");t&&this._setModalDimesions(t)},t.prototype.destroy=function(){window.removeEventListener("load",o),window.removeEventListener("resize",s);var t=document.querySelector("body");t.removeChild(this.modalWrap)}}();